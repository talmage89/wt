# Usage Testing Log

Previous test runs archived to `.docs/archive/USAGE-TESTING.log`.

## 2026-02-26T04:20:00Z

Location: ~/wt-usage-tests/2026-02-26T04-20-00/
Tests performed:
- `wt init <remote-url>`: init from a local bare repo used as remote — verified slot summary (5 slots, one on main, four vacant) and shell integration hint printed correctly
- `wt list`: verified tabular output shows slot name, branch, status, pinned flag, and last-used timestamp
- `wt -` (resume command): checked out feature/login then feature/signup; ran `wt -` — correctly navigated to most-recently-used slot (onyx-algae-wood / feature/signup), nav file written to correct path
- Shell integration: `wt shell-init bash` outputs valid `wt()` function; nav file written by binary at `/tmp/wt-nav-<ppid>`; checkout prints "wt: Navigating to <dir>"
- Reconciliation: directly ran `git checkout -b local-only-branch` inside gravel-puffin-wynd slot (bypassing wt); subsequent `wt list` silently updated state to show local-only-branch — no errors, no warnings
Result: PASS

## 2026-02-26T05:30:00Z

Location: ~/wt-usage-tests/2026-02-26T05-30-00/
Tests performed:
- Checkout branch with `/` in name (`feature/auth/oauth`): correctly checked out into slot, branch name displayed accurately in `wt list`, slot directory populated correctly — encoding/decoding of `/` works
- Eviction with full dirty state (staged + unstaged + untracked): filled all 5 slots, created dirty state in main slot (MM README.md + ?? new-untracked.txt), triggered eviction by checking out new branch — eviction stashed dirty state, restore on re-checkout returned all changes including untracked file
- Pin all slots then checkout new branch: pinned all 5 slots, ran `wt checkout -b should-fail-all-pinned` — received clear error "All worktree slots are pinned. Unpin a worktree or increase the slot count to continue." with exit 1, no partial state left
- Slot count increase via config: edited `.wt/config.toml` directly (slot_count 5→7), ran `wt list` — two new vacant slots created immediately (tundra-loam-brisk, lupine-rustic-ruby) with `git worktree add` printed to terminal
- `wt checkout -b` pre-validation: tried `wt checkout -b main` (existing branch) → "wt: Branch 'main' already exists." with exit 1, no eviction; tried `wt checkout -b new-branch nonexistent-sha` → git fatal error with exit 128, no eviction
Result: PASS

## 2026-02-26T06:30:00Z

Location: ~/wt-usage-tests/2026-02-26T06-30-00/
Tests performed:
- Stash commands (list/show/drop + error cases): created dirty state (staged + untracked), triggered eviction, verified `wt stash list` shows entry; `wt stash show <branch>` displays full diff including untracked files; `wt stash show <branch-with-no-stash>` returns "No stash found" with exit 1; `wt stash apply <nonexistent-branch>` returns "No stash found" with exit 1; `wt stash drop <branch>` prompts for confirmation, drops stash on `y`; list shows empty after drop
- `wt checkout --no-restore` + manual apply: evicted branch with dirty state (staged README.md + untracked file), then checked it back out with `--no-restore` — dirty state was NOT restored (clean working tree), stash entry was preserved; `wt stash apply <branch>` then successfully restored all changes; note: staged change is restored as unstaged after apply (standard git behavior without --index, per spec)
- Slot count decrease via config (5→3): edited config directly, ran `wt list` — 2 LRU slots (puffin-hoar-silent/main, clam-spur-dune/br-a) were silently evicted, directories removed, 3 slots remain
- Slot count decrease below pinned count: pinned all 3 remaining slots, decreased slot_count to 2 → error "Cannot reduce slot count to 2: 3 worktrees are pinned. Unpin worktrees first or choose a higher count." with exit 1, no eviction
- Fetch cooldown: first checkout records `last_fetch_at` in state.toml; second checkout within 10 min does NOT update timestamp (fetch skipped); explicit `wt fetch` always runs and updates timestamp; setting `fetch_cooldown_minutes = 0` in config causes every checkout to fetch
Result: PASS

## 2026-02-26T07:30:00Z

Location: ~/wt-usage-tests/2026-02-26T07-30-00/
Tests performed:
- `wt init` twice: second `wt init` on already-initialized container returns "Directory is not empty" with exit 1 — clear error, no corruption
- `wt checkout main` when main already checked out: correctly navigates to existing slot (orbit-sharp-light), prints "Checked out main in orbit-sharp-light", nav file written with correct path — no spurious eviction
- `wt checkout remote-only-branch` (branch exists only on remote): checkout succeeded, git DWIM created local tracking branch — but "Created local branch remote-only-branch from origin/remote-only-branch" message was NOT printed (BUG-029)
Result: BUG FOUND
Bug: BUG-029 — "Created local branch" message missing when remote-only branch checkout succeeds via git DWIM
