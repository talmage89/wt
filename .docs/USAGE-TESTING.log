## 2026-02-23T14:00:00Z

Location: ~/wt-usage-tests/2026-02-23T14-00-00/
Tests performed:
- Discovered: BUG-004 source fix was committed but dist/ was never rebuilt (pnpm build not run). Binary still had old `.option("no-restore")` code. Fixed by running `pnpm build` at start of session.
- --no-restore flag (BUG-004 fix verified post-rebuild): `wt checkout --no-restore feature/auth` succeeded (exit 0), worktree clean, stash preserved in `wt stash list` — correct
- wt stash apply (manual): `wt stash apply feature/auth` restored staged, unstaged, and untracked files; stash cleaned up on success; "Stash applied and cleaned up for 'feature/auth'." — correct (staged state becomes unstaged after apply, expected behavior of `git stash apply` without --index per VISION §5.2)
- wt stash apply on branch not in any slot: `wt stash apply feature/evict-trigger` (stash exists, branch evicted) → "wt: Branch 'feature/evict-trigger' is not checked out in any slot. Run 'wt checkout feature/evict-trigger' first." (exit 1) — correct
- wt stash apply with no stash: `wt stash apply feature/api` → "wt: No stash found for branch 'feature/api'." (exit 1) — correct
- wt fetch: ran wt fetch after adding upstream commit to feature/api; output showed "Fetched latest from remote." and remote tracking ref in bare repo updated to new commit — correct
- Template files via wt sync: configured [[templates]] in config.toml with source "templates/.env.development" (uses {{WORKTREE_DIR}} and {{BRANCH_NAME}}), ran `wt sync`; all 5 slots got correct .env.development with slot-specific WORKTREE_DIR and branch-specific BRANCH_NAME values — correct
- Template regeneration on wt checkout: checked out feature/evict-trigger into spit-lupine-cool; .env.development regenerated with BRANCH=feature/evict-trigger — correct
- Observation: generated template files (.env.development) are untracked, causing all slots to show as "dirty" in wt list — expected behavior per VISION §7.3 (user must gitignore generated files)
- LRU eviction correctness spot-checked: verified via state.toml timestamps that LRU selection correctly chose oldest slot
Result: PASS

---

## 2026-02-23T12:00:00Z

Location: ~/wt-usage-tests/2026-02-23T12-00-00/
Tests performed:
- BUG-003 fix verified: eval "$(wt shell-init bash)" then wt checkout — cwd changed correctly to slot directory, no segfault
- wt pin (by name) and wt unpin: pinned all 5 slots including a vacant one; verified pinned=true in wt list; unpinned one slot successfully
- All-slots-pinned error: with all 5 slots filled and pinned, wt checkout of new branch → "All worktree slots are pinned. Unpin a worktree or increase the slot count to continue." (exit 1) — correct per VISION.md §11
- LRU eviction with dirty state (staged + unstaged + untracked): all three file types saved in stash and shown in wt stash show — BUG-001 fix confirmed working
- wt stash list: shows branch, age, status (active), base commit correctly
- wt stash show: displays full diff of stash including untracked files
- wt stash drop: prompts for confirmation, deletes stash, wt stash list shows "No saved stashes"
- wt stash show on branch with no stash: "wt: No stash found for branch 'feature/api'." (exit 1) — correct
- Reconciliation: direct git checkout inside a slot (bypassing wt), then wt list silently updated state to show new branch — correct per VISION.md §3.2
- --no-restore flag: wt checkout --no-restore <branch> → "Unknown argument: restore" (exit 1) — BUG FOUND
Result: BUG FOUND
Bug: BUG-004 — `--no-restore` flag rejected by yargs strict mode due to boolean-negation conflict (see .docs/BUGS.md)

---

## 2026-02-23T09:00:00Z

Location: ~/wt-usage-tests/2026-02-23T09-00-00/
Tests performed:
- wt shell-init bash: output defines a syntactically valid wt() function (verified with `type wt`)
- wt checkout feature/slash-branch (branch with `/` in name): succeeded, slot assigned, wt list correct
- shell integration cwd change: eval'd shell function, then called `wt checkout` — bash segfaulted (exit 139)
- Root cause confirmed: `command -v wt` inside the shell function returns `wt` (the function name, not the binary path) because the shell function shadows the binary; `"$wt_bin" "$@"` thus calls the function recursively causing stack overflow
Result: BUG FOUND
Bug: BUG-003 — shell function infinite recursion → segfault because `command -v wt` returns function name instead of binary path (see .docs/BUGS.md)

---

## 2026-02-23T08:00:00Z

Location: ~/wt-usage-tests/2026-02-23T08-00-00/
Tests performed:
- wt init from local file:// URL (bare clone) — succeeded
- wt list from inside container: showed 1 active slot (main) + 4 vacant slots correctly
- Observed: "fatal: ref HEAD is not a symbolic ref" printed 4 times for vacant (detached HEAD) slots during reconciliation
- Bug confirmed: currentBranch() in reconcile uses stdio inherit for stderr, leaking internal git errors to terminal
Result: BUG FOUND
Bug: BUG-002 — "fatal: ref HEAD is not a symbolic ref" printed for every vacant slot on every wt command (see .docs/BUGS.md)

---

## 2026-02-23T07:05:00Z

Location: ~/wt-usage-tests/2026-02-23T10-00-00/
Tests performed:
- wt init from local repo URL (bare clone path)
- wt checkout of remote-only branches (feature/auth, feature/api, fix/bug-123, feature/db)
- wt list output format and slot assignment verification
- Stash save on LRU eviction: slot with staged + unstaged + untracked changes evicted
- Stash restore on branch re-checkout: verified staged/unstaged restored, untracked NOT restored
- git stash create --include-untracked confirmed to omit untracked files (2-parent only)
- git stash push --include-untracked confirmed to include untracked files (3-parent)
Result: BUG FOUND
Bug: BUG-001 — untracked files silently lost during slot eviction due to git stash create not supporting --include-untracked (see .docs/BUGS.md)
